--- libsoup/soup-server.c.orig	2011-08-05 15:34:27.069000180 +0300
+++ libsoup/soup-server.c	2011-08-05 15:35:41.724000248 +0300
@@ -770,6 +770,15 @@
 
 		uri = soup_message_get_uri (req);
 		decoded_path = soup_uri_decode (uri->path);
+
+        if (strstr (decoded_path, "/../") ||
+            g_str_has_suffix (decoded_path, "/..")) {
+                /* Introducing new ".." segments is not allowed */
+                g_free (decoded_path);
+                soup_message_set_status (req, SOUP_STATUS_BAD_REQUEST);
+                return;
+        }
+
 		soup_uri_set_path (uri, decoded_path);
 		g_free (decoded_path);
 	}
