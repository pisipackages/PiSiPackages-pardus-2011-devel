diff -Naur ncompress-4.2.4.2/Changes ncompress-4.2.4.3/Changes
--- ncompress-4.2.4.2/Changes	2007-09-07 06:28:42.000000000 +0300
+++ ncompress-4.2.4.3/Changes	2010-01-30 01:54:07.000000000 +0200
@@ -1,3 +1,8 @@
+(N)compress version 4.2.4.3
+	o Check return value of chown().
+	o Fix from Fedora for checking malloc() return.
+	o Fix from Fedora/gzip to avoid integer overflow for CVE-2010-0001.
+
 (N)compress version 4.2.4.2
 	o Integrate build/man touchups from Debian.
 	o Add fix from Fedora for handling of 0 byte files.
diff -Naur ncompress-4.2.4.2/compress42.c ncompress-4.2.4.3/compress42.c
--- ncompress-4.2.4.2/compress42.c	2007-09-07 06:28:42.000000000 +0300
+++ ncompress-4.2.4.3/compress42.c	2010-01-30 01:54:07.000000000 +0200
@@ -713,7 +713,13 @@
     	nomagic = 1;	/* Original didn't have a magic number */
 #endif
 
-    	filelist = fileptr = (char **)malloc(argc*sizeof(char *));
+    	filelist = (char **)malloc(argc*sizeof(char *));
+    	if (filelist == NULL)
+		{
+			fprintf(stderr, "Cannot allocate memory for file list.\n");
+			exit (1);
+		}
+    	fileptr = filelist;
     	*filelist = NULL;
 
     	if((progname = strrchr(argv[0], '/')) != 0)
@@ -1236,7 +1242,12 @@
 						exit_code = 1;
 					}
 #ifndef	DOS
-					chown(ofname, infstat.st_uid, infstat.st_gid);	/* Copy ownership */
+					if (chown(ofname, infstat.st_uid, infstat.st_gid))	/* Copy ownership */
+					{
+						fprintf(stderr, "\nchown error (ignored) ");
+						perror(ofname);
+						exit_code = 1;
+					}
 #endif
 #endif
 					remove_ofname = 0;
@@ -1670,7 +1681,8 @@
 				int				e;
 				int				o;
 
-				e = insize-(o = (posbits>>3));
+				o = posbits >> 3;
+				e = o <= insize ? insize - o : 0;
 
 				for (i = 0 ; i < e ; ++i)
 					inbuf[i] = inbuf[i+o];
diff -Naur ncompress-4.2.4.2/patchlevel.h ncompress-4.2.4.3/patchlevel.h
--- ncompress-4.2.4.2/patchlevel.h	2007-09-07 06:34:03.000000000 +0300
+++ ncompress-4.2.4.3/patchlevel.h	2010-01-30 01:54:07.000000000 +0200
@@ -1,2 +1,2 @@
-static char	ident[] = "@(#)(N)compress 4.2.4.2";
+static char	ident[] = "@(#)(N)compress 4.2.4.3";
 #define	version_id (ident+4)
