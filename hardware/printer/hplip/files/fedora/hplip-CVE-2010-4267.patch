diff -up hplip-3.10.9/io/hpmud/pml.c.CVE-2010-4267 hplip-3.10.9/io/hpmud/pml.c
--- hplip-3.10.9/io/hpmud/pml.c.CVE-2010-4267	2010-09-26 18:07:25.000000000 +0100
+++ hplip-3.10.9/io/hpmud/pml.c	2011-01-17 17:21:26.018127900 +0000
@@ -504,6 +504,8 @@ enum HPMUD_RESULT hpmud_get_pml(HPMUD_DE
       p += 2;                               /* eat type and length */
    }
    
+   if (dLen > buf_size)
+      dLen = buf_size;
    memcpy(buf, p, dLen);
    *bytes_read = dLen; 
    *type = dt;
