--- libwmf-0.2.8.4/src/extra/gd/gd_png.c.cve-2007-2756	2007-06-13 11:20:03.000000000 -0600
+++ libwmf-0.2.8.4/src/extra/gd/gd_png.c	2007-06-13 11:21:58.000000000 -0600
@@ -78,8 +78,11 @@
 gdPngReadData (png_structp png_ptr,
 	       png_bytep data, png_size_t length)
 {
-  gdGetBuf (data, length, (gdIOCtx *)
-	    png_get_io_ptr (png_ptr));
+  int check;
+  check = gdGetBuf (data, length, (gdIOCtx *) png_get_io_ptr (png_ptr));
+  if (check != length) {
+    png_error(png_ptr, "Read Error: truncated data");
+  }
 }
 
 static void
